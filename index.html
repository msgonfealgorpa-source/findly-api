<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Findly AI</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

<style>
:root { --main-purple:#6366f1; --dark-bg:#0f172a }
body{font-family:'Cairo',sans-serif;background:var(--dark-bg);color:white;margin:0}
.hero-section{background:linear-gradient(180deg,#6366f1,#4f46e5);border-bottom-left-radius:80px;border-bottom-right-radius:80px;padding:30px 20px 80px}
.search-container{background:white;border-radius:100px;display:flex;align-items:center;padding:5px;max-width:500px;margin:30px auto 0}
.search-input{flex:1;border:none;outline:none;padding:12px 20px;font-weight:bold;color:#333}
.search-btn{background:#6366f1;color:white;border-radius:100px;padding:12px 30px;font-weight:900}
.cat-grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-top:-40px;padding:0 25px}
.cat-card{background:rgba(255,255,255,.1);border-radius:30px;padding:25px;text-align:center;font-weight:bold;cursor:pointer}
.ai-recommendation-box{background:rgba(99,102,241,.15);border-right:4px solid #fbbf24;padding:12px;border-radius:18px;margin-top:10px;font-size:12px}
</style>
</head>

<body>

<section class="hero-section text-center">
<h1 class="text-4xl font-black">Ø§Ø¹Ø«Ø± Ø¹Ù„Ù‰ Ø®ÙŠØ§Ø±Ùƒ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ Ø¨Ø°ÙƒØ§Ø¡</h1>
<p class="opacity-80 mt-2">Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ Ù„Ø§Ø®ØªÙŠØ§Ø± Ø£ÙØ¶Ù„ Ù…Ù†ØªØ¬</p>

<div class="search-container">
<button onclick="startVoiceSearch()">ğŸ¤</button>
<input id="search-q" class="search-input" placeholder="Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªØ´ØªØ±ÙŠØŸ">
<button onclick="runSmartSearch()" class="search-btn">Ø¨Ø­Ø« Ø°ÙƒÙŠ</button>
</div>
</section>

<div class="cat-grid">
<div onclick="quickSearch('Ø³Ù…Ø§Ø¹Ø§Øª Ù„Ø§Ø³Ù„ÙƒÙŠØ©')" class="cat-card">ğŸ§ Ø³Ù…Ø§Ø¹Ø§Øª</div>
<div onclick="quickSearch('Ù‡ÙˆØ§ØªÙ Ø°ÙƒÙŠØ©')" class="cat-card">ğŸ“± Ù‡ÙˆØ§ØªÙ</div>
<div onclick="quickSearch('Ø£ÙØ¶Ù„ Ù„Ø§Ø¨ØªÙˆØ¨ Ù„Ù„Ø¨Ø±Ù…Ø¬Ø©')" class="cat-card">ğŸ’» Ù„Ø§Ø¨ØªÙˆØ¨</div>
<div onclick="quickSearch('Ø³Ø§Ø¹Ø§Øª Ø°ÙƒÙŠØ©')" class="cat-card">âŒš Ø³Ø§Ø¹Ø§Øª</div>
</div>

<main class="max-w-4xl mx-auto mt-10 px-6 pb-20">
<div id="status-msg" class="text-center mb-6 text-indigo-400 font-bold"></div>
<div id="results" class="space-y-6"></div>
</main>

<script>
const API_BASE = "https://findly-api.onrender.com/search?q=";

/* ØªØ­Ù„ÙŠÙ„ Ù†ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
function analyzeUserIntent(q){
    q=q.toLowerCase();
    return {
        camera: q.includes('ÙƒØ§Ù…ÙŠØ±Ø§')||q.includes('camera'),
        battery: q.includes('Ø¨Ø·Ø§Ø±ÙŠØ©')||q.includes('battery'),
        gaming: q.includes('Ø£Ù„Ø¹Ø§Ø¨')||q.includes('gaming'),
        cheap: q.includes('Ø±Ø®ÙŠØµ')||q.includes('cheap'),
        laptop: q.includes('Ù„Ø§Ø¨ØªÙˆØ¨')||q.includes('laptop'),
        phone: q.includes('Ù‡Ø§ØªÙ')||q.includes('phone')
    };
}

/* ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ø°ÙƒØ§Ø¡ */
function smartRank(items, intent){
    return items.map(item=>{
        let score = parseFloat(item.rating)||4;

        const desc = (item.name + " " + item.description).toLowerCase();

        if(intent.camera && desc.includes('camera')) score+=3;
        if(intent.battery && desc.includes('battery')) score+=3;
        if(intent.gaming && desc.includes('gaming')) score+=3;
        if(intent.cheap && parseFloat(item.price)<300) score+=4;

        item._score = score;
        return item;
    }).sort((a,b)=>b._score-a._score);
}

/* Ø§Ù„Ø¨Ø­Ø« */
async function runSmartSearch(){
    const q=document.getElementById('search-q').value.trim();
    if(!q) return;

    document.getElementById('status-msg').innerText="â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...";
    document.getElementById('results').innerHTML="";

    try{
        const res = await fetch(API_BASE+encodeURIComponent(q));
        const data = await res.json();

        if(!data.top || !data.top.length){
            document.getElementById('status-msg').innerText="âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬";
            return;
        }

        const intent = analyzeUserIntent(q);
        const ranked = smartRank(data.top, intent);

        document.getElementById('status-msg').innerText="ğŸ” Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«:";

        ranked.slice(0,5).forEach((item,i)=>{
            const card=`
            <div class="bg-white/10 p-6 rounded-3xl border border-white/10">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="font-black">${item.name}</h3>
                    <span class="text-yellow-400">#${i+1}</span>
                </div>

                <p class="text-sm opacity-80">${item.description||''}</p>

                <div class="flex justify-between items-center mt-3">
                    <div class="text-indigo-400 font-black">${item.price||''}</div>
                    <a href="${item.link}" target="_blank"
                       class="bg-indigo-500 px-4 py-2 rounded-full text-xs font-bold">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬</a>
                </div>

                <div class="ai-recommendation-box">
                    ğŸ¤– ØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø°ÙƒÙŠ
                </div>
            </div>`;
            document.getElementById('results').insertAdjacentHTML('beforeend',card);
        });

    }catch(e){
        document.getElementById('status-msg').innerText="âš ï¸ Ø®Ø·Ø£ Ø§ØªØµØ§Ù„";
    }
}

/* Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØµÙˆØªÙŠ */
function startVoiceSearch(){
    const SpeechRecognition = window.SpeechRecognition||window.webkitSpeechRecognition;
    if(!SpeechRecognition) return alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØµÙˆØª");
    const rec=new SpeechRecognition();
    rec.lang='ar-SA';
    rec.onresult=e=>{
        document.getElementById('search-q').value=e.results[0][0].transcript;
        runSmartSearch();
    }
    rec.start();
}

/* Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹ */
function quickSearch(v){
    document.getElementById('search-q').value=v;
    runSmartSearch();
}
</script>

</body>
</html>
