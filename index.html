<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Findly AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #0f172a; color: white; margin: 0; }
        .main-bg { background: linear-gradient(180deg, #6366f1 0%, #4f46e5 100%); border-bottom-left-radius: 80px; border-bottom-right-radius: 80px; padding-bottom: 40px; }
        .glass-btn { background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 25px; transition: 0.3s; }
        .search-container { background: white; border-radius: 50px; padding: 6px; display: flex; align-items: center; box-shadow: 0 15px 30px rgba(0,0,0,0.2); }
        .search-input { border: none; outline: none; padding: 10px 20px; flex-grow: 1; color: #333; font-weight: bold; border-radius: 50px; }
        .btn-purple { background: #a855f7; color: white; padding: 12px 30px; border-radius: 40px; font-weight: 900; }
        .category-item { background: rgba(255, 255, 255, 0.1); border-radius: 30px; padding: 20px; text-align: center; font-weight: bold; border: 1px solid rgba(255,255,255,0.1); transition: 0.3s; }
        .category-item:hover { background: rgba(255, 255, 255, 0.2); }
        .hidden { display: none !important; }
        .mic-active { color: #ef4444 !important; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }
    </style>
</head>
<body>

<div id="auth-page" class="min-h-screen flex items-center justify-center p-6">
    <div class="w-full max-w-sm text-center">
        <h1 class="text-5xl font-black italic mb-10">Findly<span class="text-yellow-400">.</span></h1>
        <div class="glass-btn p-8 space-y-4">
            <h2 id="auth-title" class="text-xl font-bold mb-4">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" class="w-full p-4 rounded-2xl bg-white/10 border border-white/20 outline-none">
            <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" class="w-full p-4 rounded-2xl bg-white/10 border border-white/20 outline-none">
            <input type="password" id="confirm-pass" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" class="hidden w-full p-4 rounded-2xl bg-white/10 border border-white/20 outline-none">
            <button onclick="handleAuth()" class="btn-purple w-full">Ø¯Ø®ÙˆÙ„</button>
            <p onclick="toggleAuth()" id="toggle-text" class="text-xs cursor-pointer opacity-70 mt-4">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</p>
        </div>
    </div>
</div>

<div id="main-app" class="hidden">
    <div class="main-bg px-6 pt-10">
        <div class="flex justify-between items-center mb-16">
            <div class="flex items-center gap-2">
                <button onclick="logout()" class="text-xs text-red-300 font-bold bg-red-500/20 px-4 py-2 rounded-full">Ø®Ø±ÙˆØ¬</button>
                <div id="welcome-box" class="glass-btn px-4 py-2 text-xs font-bold">Ø·Ø§Ø¨ ÙŠÙˆÙ…ÙƒØŒ Ù…Ø³ØªØ®Ø¯Ù…</div>
            </div>
            <div class="text-3xl font-black italic">Findly<span class="text-yellow-400">.</span></div>
        </div>

        <div class="text-center mb-10">
            <h1 class="text-4xl font-black mb-4 leading-tight">Ø§Ø¹Ø«Ø± Ø¹Ù„Ù‰ Ø®ÙŠØ§Ø±Ùƒ<br>Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ Ø¨Ø°ÙƒØ§Ø¡</h1>
            <p class="text-sm opacity-80 max-w-xs mx-auto">Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø´Ø®ØµÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ­Ù„Ù„ Ø¢Ù„Ø§Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„ÙŠÙ‚ØªØ±Ø­ Ù„Ùƒ Ø§Ù„Ø£ÙØ¶Ù„ ÙÙ‚Ø·.</p>
        </div>

        <div class="max-w-md mx-auto search-container">
            <button id="mic-btn" class="p-3 text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-20a3 3 0 00-3 3v8a3 3 0 006 0V5a3 3 0 00-3-3z" />
                </svg>
            </button>
            <input type="text" id="search-input" placeholder="Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªØ´ØªØ±ÙŠØŸ" class="search-input">
            <button onclick="runSearch()" class="btn-purple">Ø¨Ø­Ø«</button>
        </div>
    </div>

    <div class="px-6 py-10 max-w-4xl mx-auto">
        <div id="cats-area" class="grid grid-cols-2 gap-4 mb-10">
            <div class="category-item">ğŸ“± Ù‡ÙˆØ§ØªÙ</div>
            <div class="category-item">ğŸ§ Ø³Ù…Ø§Ø¹Ø§Øª</div>
            <div class="category-item">âŒš Ø³Ø§Ø¹Ø§Øª</div>
            <div class="category-item">ğŸ’» Ù„Ø§Ø¨ØªÙˆØ¨</div>
        </div>

        <div id="results-area" class="space-y-6">
            </div>
    </div>
</div>

<script>
    const API = "https://findly-api.onrender.com";
    let isLoginMode = true;

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„ ---
    function toggleAuth() {
        isLoginMode = !isLoginMode;
        document.getElementById('confirm-pass').classList.toggle('hidden');
        document.getElementById('auth-title').innerText = isLoginMode ? 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯';
        document.getElementById('toggle-text').innerText = isLoginMode ? 'Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†' : 'Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ';
    }

    function handleAuth() {
        const email = document.getElementById('email').value;
        if(email) {
            localStorage.setItem('logged', 'true');
            localStorage.setItem('user', email.split('@')[0]);
            location.reload();
        }
    }

    function logout() { localStorage.clear(); location.reload(); }

    // --- Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØµÙˆØªÙŠ ---
    const micBtn = document.getElementById('mic-btn');
    const Speech = window.SpeechRecognition || window.webkitSpeechRecognition;
    if(Speech) {
        const rec = new Speech();
        micBtn.onclick = () => { rec.start(); micBtn.classList.add('mic-active'); };
        rec.onresult = (e) => {
            document.getElementById('search-input').value = e.results[0][0].transcript;
            micBtn.classList.remove('mic-active');
            runSearch();
        };
        rec.onerror = () => micBtn.classList.remove('mic-active');
    }

    // --- Ø§Ù„Ø¨Ø­Ø« ÙˆØ¹Ø±Ø¶ Ø°ÙƒØ§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ---
    async function runSearch() {
        const q = document.getElementById('search-input').value;
        const container = document.getElementById('results-area');
        if(!q) return;

        container.innerHTML = '<p class="text-center animate-pulse">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>';
        
        try {
            const res = await fetch(`${API}/search?q=${q}`);
            const data = await res.json();
            container.innerHTML = '';

            data.top.forEach(item => {
                container.innerHTML += `
                    <div class="bg-slate-800/50 p-5 rounded-[30px] border border-white/5 flex gap-4 items-center">
                        <img src="${item.image}" class="w-20 h-20 object-contain bg-white rounded-2xl p-2">
                        <div class="flex-grow">
                            <h3 class="font-bold text-sm">${item.name}</h3>
                            <div class="text-yellow-400 text-xs my-1">â­â­â­â­â­ <span class="text-white opacity-50">(5/5)</span></div>
                            <div class="bg-indigo-500/20 p-2 rounded-xl border-r-4 border-indigo-400 text-[10px] mt-2 italic">
                                ğŸ’¡ Ø°ÙƒØ§Ø¡ Findly: Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù‡Ùˆ Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹ ÙˆØªÙ‚ÙŠÙŠÙ…Ø§Ù‹ ÙÙŠ ÙØ¦ØªÙ‡ Ø­Ø§Ù„ÙŠØ§Ù‹.
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-indigo-400 font-black mb-2">${item.price}</div>
                            <a href="${item.link}" target="_blank" class="btn-purple py-2 px-4 text-xs">Ø´Ø±Ø§Ø¡</a>
                        </div>
                    </div>`;
            });
        } catch { container.innerHTML = '<p class="text-center text-red-400">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±</p>'; }
    }

    // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø³Ø¬Ù„Ø§Ù‹
    if(localStorage.getItem('logged')) {
        document.getElementById('auth-page').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
        document.getElementById('welcome-box').innerText = "Ø·Ø§Ø¨ ÙŠÙˆÙ…ÙƒØŒ " + localStorage.getItem('user');
    }
</script>
</body>
</html>
