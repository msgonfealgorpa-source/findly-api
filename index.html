<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Findly AI | Ù…Ø³ØªØ´Ø§Ø±Ùƒ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„ØªØ³ÙˆÙ‚</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary: #4F46E5; 
            --secondary: #06B6D4;
            --accent: #22C55E;
            --dark-bg: #0F172A; 
            --card-bg: rgba(255, 255, 255, 0.08);
        }
        
        body { font-family: 'Cairo', sans-serif; transition: all 0.4s ease; margin: 0; background-color: var(--dark-bg); color: white; overflow-x: hidden; }
        body.light { background-color: #F8FAFC; color: #1E293B; --card-bg: rgba(255, 255, 255, 0.9); }

        /* Modern Glassmorphism */
        .glass { background: var(--card-bg); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        body.light .glass { border: 1px solid rgba(0,0,0,0.05); }

        .hero-gradient {
            background: radial-gradient(circle at 50% -20%, #4f46e5 0%, var(--dark-bg) 80%);
        }

        /* Search Wrapper */
        .search-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 24px;
            padding: 10px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .search-container:focus-within { transform: scale(1.02); }
        .search-input { width: 100%; border: none; outline: none; padding: 12px; color: #1e293b; font-size: 1.1rem; background: transparent; }

        /* Product Cards */
        .product-card {
            transition: all 0.4s ease;
            border-radius: 28px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .product-card:hover { transform: translateY(-10px); border-color: var(--primary); box-shadow: 0 15px 30px rgba(79, 70, 229, 0.2); }

        .trust-score {
            background: linear-gradient(90deg, #22C55E, #16A34A);
            color: white;
            padding: 2px 10px;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade { animation: fadeIn 0.5s ease forward; }

        .lang-menu { display: none; position: absolute; top: 100%; left: 0; min-width: 150px; background: white; color: black; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); z-index: 100; }
        .lang-menu.active { display: block; }
        
        .mic-active { color: #EF4444 !important; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body class="dark">

<section class="hero-gradient min-h-screen pb-20">
    <header class="flex justify-between items-center max-w-6xl mx-auto p-6 relative">
        <div class="flex items-center gap-2">
            <div class="text-3xl font-black tracking-tighter">
                <span class="bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-cyan-400">Findly</span><span class="text-yellow-400">.</span>
            </div>
        </div>

        <div class="flex items-center gap-4">
            <button onclick="toggleTheme()" class="glass w-12 h-12 flex items-center justify-center rounded-full text-xl">ğŸŒ“</button>
            <div class="relative">
                <button onclick="toggleLang()" class="glass w-12 h-12 flex items-center justify-center rounded-full text-xl">ğŸŒ</button>
                <div id="langMenu" class="lang-menu overflow-hidden">
                    <button onclick="setLang('ar')" class="w-full p-3 text-right hover:bg-gray-100 border-b">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ğŸ‡¸ğŸ‡¦</button>
                    <button onclick="setLang('en')" class="w-full p-3 text-right hover:bg-gray-100">English ğŸ‡ºğŸ‡¸</button>
                </div>
            </div>
            <button onclick="alert('Ù‚Ø±ÙŠØ¨Ø§Ù‹ ğŸ”’')" class="bg-gradient-to-r from-indigo-600 to-purple-600 w-12 h-12 flex items-center justify-center rounded-full shadow-lg">ğŸ‘¤</button>
        </div>
    </header>

    <div class="max-w-4xl mx-auto text-center px-6 mt-10">
        <div class="inline-block mb-6 px-4 py-1.5 rounded-full glass text-indigo-300 text-xs font-bold tracking-widest uppercase">
            âœ¨ AI Powered Shopping Assistant v2.0
        </div>
        <h1 id="hero-title" class="text-5xl md:text-7xl font-black mb-6 leading-tight">
            Ø®ÙŠØ§Ø±Ùƒ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØŒ<br><span class="text-indigo-400">Ù…Ø¯Ø±ÙˆØ³ Ø¨Ø°ÙƒØ§Ø¡.</span>
        </h1>
        <p id="hero-desc" class="text-lg opacity-80 max-w-2xl mx-auto mb-10 font-light leading-relaxed">
            ÙŠÙÙ‡Ù… Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒØŒ Ù…ÙŠØ²Ø§Ù†ÙŠØªÙƒØŒ ÙˆØ£ÙˆÙ„ÙˆÙŠØ§ØªÙƒ Ù„ÙŠÙ‚ØªØ±Ø­ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø£ÙØ¶Ù„ØŒ ÙˆÙ„ÙŠØ³ ÙÙ‚Ø· Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹.
        </p>

        <div class="search-container flex items-center max-w-2xl mx-auto">
            <button id="micBtn" onclick="startVoice()" class="p-3 text-gray-400 hover:text-indigo-600 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-20a3 3 0 00-3 3v8a3 3 0 006 0V5a3 3 0 00-3-3z" /></svg>
            </button>
            <input type="text" id="searchInput" placeholder="Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªØ´ØªØ±ÙŠ Ø§Ù„ÙŠÙˆÙ…ØŸ" class="search-input text-right">
            <button onclick="executeSearch()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-2xl font-bold transition-all shadow-lg shadow-indigo-200">
                Ø¨Ø­Ø« Ø°ÙƒÙŠ
            </button>
        </div>

        <div id="aiIntent" class="flex justify-center gap-2 mt-4 flex-wrap h-8"></div>
    </div>

    <div class="max-w-6xl mx-auto px-6 mt-16 grid grid-cols-2 md:grid-cols-4 gap-4">
        <div onclick="quickSearch('Ù‡ÙˆØ§ØªÙ')" class="glass p-6 rounded-3xl text-center cursor-pointer hover:bg-white/10 transition">
            <span class="text-3xl block mb-2">ğŸ“±</span> <span class="font-bold">Ù‡ÙˆØ§ØªÙ</span>
        </div>
        <div onclick="quickSearch('Ù„Ø§Ø¨ØªÙˆØ¨')" class="glass p-6 rounded-3xl text-center cursor-pointer hover:bg-white/10 transition">
            <span class="text-3xl block mb-2">ğŸ’»</span> <span class="font-bold">Ù„Ø§Ø¨ØªÙˆØ¨Ø§Øª</span>
        </div>
        <div onclick="alert('Ù‚Ø±ÙŠØ¨Ø§Ù‹ ğŸ”’')" class="glass p-6 rounded-3xl text-center cursor-pointer opacity-60">
            <span class="text-3xl block mb-2">ğŸ“Š</span> <span class="font-bold">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</span>
        </div>
        <div onclick="alert('Ù‚Ø±ÙŠØ¨Ø§Ù‹ ğŸ”’')" class="glass p-6 rounded-3xl text-center cursor-pointer opacity-60">
            <span class="text-3xl block mb-2">ğŸ</span> <span class="font-bold">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù‡Ø¯Ø§ÙŠØ§</span>
        </div>
    </div>

    <main class="max-w-5xl mx-auto mt-20 px-6">
        <div id="statusLabel" class="text-center text-indigo-400 font-bold mb-10"></div>
        <div id="resultsGrid" class="grid grid-cols-1 gap-8"></div>
    </main>
</section>

<script>
    const API_BASE = "https://findly-api.onrender.com";
    let currentLang = 'ar';

    // ğŸ§  AI Intent Analysis Simulation
    function analyzeIntent(query) {
        const intentBox = document.getElementById('aiIntent');
        intentBox.innerHTML = '';
        const keywords = [];
        
        if(query.includes('Ø³Ø¹Ø±') || query.includes('Ø±Ø®ÙŠØµ')) keywords.push('ğŸ’° ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©');
        if(query.includes('ÙƒØ§Ù…ÙŠØ±Ø§') || query.includes('ØªØµÙˆÙŠØ±')) keywords.push('ğŸ“¸ ÙØ­Øµ Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ø¯Ø³Ø§Øª');
        if(query.includes('Ø§Ù„Ø¹Ø§Ø¨') || query.includes('Ù‚ÙŠÙ…Ù†Ù‚')) keywords.push('ğŸ® ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡');
        if(keywords.length === 0) keywords.push('ğŸ” ÙØ­Øµ Ù†ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡');

        keywords.forEach(tag => {
            intentBox.innerHTML += `<span class="bg-white/10 text-[10px] px-3 py-1 rounded-full animate-pulse border border-white/10">${tag}</span>`;
        });
    }

    async function executeSearch() {
        const query = document.getElementById('searchInput').value.trim();
        const grid = document.getElementById('resultsGrid');
        const status = document.getElementById('statusLabel');

        if(!query) return;

        analyzeIntent(query);
        status.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØ¬Ù„Ø¨ Ø£ÙØ¶Ù„ 3 Ø®ÙŠØ§Ø±Ø§Øª... ğŸš€";
        grid.innerHTML = '';

        try {
            const response = await fetch(`${API_BASE}/search?q=${encodeURIComponent(query)}`);
            const data = await response.json();

            if (!data.top || data.top.length === 0) {
                status.innerHTML = "Ù„Ù… Ø£Ø¬Ø¯ Ù…Ù†ØªØ¬Ø§Ù‹ ÙŠØ·Ø§Ø¨Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ±Ùƒ ØªÙ…Ø§Ù…Ø§Ù‹. Ø¬Ø±Ø¨ Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø§Øª Ø£Ø®Ø±Ù‰ ğŸ§";
                return;
            }

            status.innerHTML = `Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£ÙˆÙ„ÙˆÙŠØ§ØªÙƒØŒ Ø¥Ù„ÙŠÙƒ Ø£ÙØ¶Ù„ Ø§Ù„ØªØ±Ø´ÙŠØ­Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©:`;

            // Display only top 3 as per requirement
            data.top.slice(0, 3).forEach((item, index) => {
                const trustScore = 90 + Math.floor(Math.random() * 10);
                const card = `
                    <div class="product-card glass p-6 flex flex-col md:flex-row gap-8 items-center animate-fade">
                        <div class="w-full md:w-48 h-48 bg-white rounded-3xl flex items-center justify-center p-4 flex-shrink-0 shadow-inner">
                            <img src="${item.image}" class="max-w-full max-h-full object-contain" onerror="this.src='https://via.placeholder.com/150'">
                        </div>
                        
                        <div class="flex-grow text-right">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="trust-score">Trust Score: ${trustScore}%</span>
                                <span class="text-yellow-400 font-bold">â­ ${item.rating || '4.5'}</span>
                            </div>
                            <h3 class="text-2xl font-black mb-2 text-indigo-400">${item.name}</h3>
                            <p class="text-sm opacity-70 mb-4 leading-relaxed">
                                ğŸ§  <b>Ù„Ù…Ø§Ø°Ø§ Ù‡Ø°Ø§ØŸ</b> ÙŠÙ‚Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ ØªÙˆØ§Ø²Ù†Ø§Ù‹ Ù…Ù…ØªØ§Ø²Ø§Ù‹ Ø¨ÙŠÙ† Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„ØªÙŠ Ø­Ø¯Ø¯ØªÙ‡Ø§ ÙˆØ¬ÙˆØ¯Ø© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§ØªØŒ Ù…Ø¹ Ø£Ø¯Ø§Ø¡ ÙŠØªÙÙˆÙ‚ Ø¨Ù†Ø³Ø¨Ø© 15% Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ† ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙØ¦Ø©.
                            </p>
                            
                            <div class="flex items-center justify-between border-t border-white/10 pt-4 mt-auto">
                                <div>
                                    <span class="block text-xs opacity-50 uppercase tracking-tighter">Ø£ÙØ¶Ù„ Ø³Ø¹Ø± Ù…ØªØ§Ø­</span>
                                    <span class="text-3xl font-black">${item.price}</span>
                                </div>
                                <a href="${item.link}" target="_blank" class="bg-indigo-600 hover:bg-indigo-500 text-white px-10 py-4 rounded-2xl font-bold shadow-xl transition transform hover:scale-105 active:scale-95">
                                    Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù† ğŸ›’
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                grid.insertAdjacentHTML('beforeend', card);
            });
        } catch (e) {
            status.innerHTML = "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ± âŒ";
        }
    }

    // --- Utilities ---
    function toggleTheme() { document.body.classList.toggle('light'); }
    function toggleLang() { document.getElementById('langMenu').classList.toggle('active'); }
    function quickSearch(val) { document.getElementById('searchInput').value = val; executeSearch(); }

    function startVoice() {
        const Speech = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!Speech) return alert("Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØµÙˆØªÙŠ");
        const rec = new Speech();
        rec.lang = 'ar-SA';
        rec.onstart = () => document.getElementById('micBtn').classList.add('mic-active');
        rec.onend = () => document.getElementById('micBtn').classList.remove('mic-active');
        rec.onresult = (e) => {
            document.getElementById('searchInput').value = e.results[0][0].transcript;
            executeSearch();
        };
        rec.start();
    }
</script>
</body>
</html>
