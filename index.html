<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Findly AI | Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

<style>
:root{--main-purple:#6366f1;--dark-bg:#0f172a;}
body{font-family:'Cairo',sans-serif;margin:0;background:var(--dark-bg);color:white}
.hero-section{background:linear-gradient(180deg,var(--main-purple),#4f46e5);border-radius:0 0 80px 80px;padding:30px 20px 80px}
.search-container{background:white;border-radius:100px;display:flex;align-items:center;padding:5px;max-width:500px;margin:30px auto}
.search-input{flex:1;border:none;outline:none;padding:12px 20px;font-weight:bold}
.search-btn{background:var(--main-purple);color:white;border-radius:100px;padding:12px 30px;font-weight:900;border:none}
.cat-grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-top:-40px;padding:0 25px}
.cat-card{background:rgba(255,255,255,.1);border-radius:30px;padding:25px;text-align:center;font-weight:bold;cursor:pointer}
.ai-recommendation-box{background:rgba(99,102,241,.15);border-right:4px solid #fbbf24;padding:12px;border-radius:18px;margin-top:10px;font-size:12px}
.hidden{display:none}
</style>
</head>

<body>

<section id="app-view">
<div class="hero-section text-center">
<h1 id="main-title" class="text-4xl font-black mb-4">Ø§Ø¹Ø«Ø± Ø¹Ù„Ù‰ Ø®ÙŠØ§Ø±Ùƒ<br>Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ Ø¨Ø°ÙƒØ§Ø¡</h1>
<p id="main-desc" class="text-sm opacity-80 mb-8">Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø´Ø®ØµÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ­Ù„Ù„ Ø¢Ù„Ø§Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„ÙŠÙ‚ØªØ±Ø­ Ù„Ùƒ Ø§Ù„Ø£ÙØ¶Ù„ ÙÙ‚Ø·.</p>

<div class="search-container">
<input type="text" id="search-q" placeholder="Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªØ´ØªØ±ÙŠØŸ" class="search-input">
<button onclick="runSmartSearch()" class="search-btn">Ø¨Ø­Ø« Ø°ÙƒÙŠ</button>
</div>
</div>

<div class="cat-grid">
<div onclick="quickSearch('Ø³Ù…Ø§Ø¹Ø§Øª Ù„Ø§Ø³Ù„ÙƒÙŠØ©')" class="cat-card">ğŸ§ Ø³Ù…Ø§Ø¹Ø§Øª</div>
<div onclick="quickSearch('Ù‡ÙˆØ§ØªÙ Ø°ÙƒÙŠØ©')" class="cat-card">ğŸ“± Ù‡ÙˆØ§ØªÙ</div>
<div onclick="quickSearch('Ù„Ø§Ø¨ØªÙˆØ¨ Ø¹Ù…Ù„')" class="cat-card">ğŸ’» Ù„Ø§Ø¨ØªÙˆØ¨</div>
</div>

<main class="max-w-4xl mx-auto mt-10 px-6 pb-20">
<div id="status-msg" class="text-center font-bold text-indigo-400 mb-6"></div>
<div id="results" class="space-y-6"></div>
</main>
</section>

<div id="toast-msg" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-yellow-500 text-black px-6 py-3 rounded-full font-bold shadow-2xl hidden"></div>

<script>
const API_BASE="https://api.apify.com/v2/datasets/AadkSySMvKXCYSBhW/items?clean=true";

/* ====== ÙÙ‡Ù… Ù†ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ====== */
function analyzeUserIntent(query){
const q=query.toLowerCase();
return{
price:q.includes("Ø±Ø®ÙŠØµ")||q.includes("cheap"),
best:q.includes("Ø£ÙØ¶Ù„")||q.includes("best"),
gaming:q.includes("gaming")||q.includes("Ø£Ù„Ø¹Ø§Ø¨"),
camera:q.includes("camera")||q.includes("ÙƒØ§Ù…ÙŠØ±Ø§"),
battery:q.includes("battery")||q.includes("Ø¨Ø·Ø§Ø±ÙŠØ©")
};
}

/* ====== ÙÙ„ØªØ±Ø© + ØªØ±ØªÙŠØ¨ Ø°ÙƒÙŠ ====== */
function smartFilterAndRank(data,query){
const intent=analyzeUserIntent(query);
const q=query.toLowerCase();

return data.map(item=>{
const title=(item.title||item.name||'').toLowerCase();
const desc=(item.description||'').toLowerCase();
let score=0;

if(title.includes(q))score+=6;
if(desc.includes(q))score+=4;
if(intent.price && item.price && item.price<300)score+=6;
if(intent.gaming && desc.includes("gaming"))score+=6;
if(intent.camera && desc.includes("camera"))score+=6;
if(intent.battery && desc.includes("battery"))score+=6;

return {...item,_score:score};
})
.filter(i=>i._score>2)
.sort((a,b)=>b._score-a._score);
}

/* ====== Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹ ====== */
function quickSearch(v){
document.getElementById('search-q').value=v;
runSmartSearch();
}

/* ====== Ù†Ø¸Ø§Ù… ØªØ­Ø¯ÙŠØ¯ 3 Ù…Ø±Ø§Øª ====== */
function canSearchToday(){
const today=new Date().toISOString().slice(0,10);
const saved=localStorage.getItem("findly_date");
let count=parseInt(localStorage.getItem("findly_searches")||"0");

if(saved!==today){
localStorage.setItem("findly_date",today);
localStorage.setItem("findly_searches","0");
return true;
}
return count<3;
}

function increaseSearchCount(){
let count=parseInt(localStorage.getItem("findly_searches")||"0");
localStorage.setItem("findly_searches",count+1);
}

function showLimitMsg(){
const t=document.getElementById("toast-msg");
t.innerText="ğŸš€ Ø§Ø³ØªÙ‡Ù„ÙƒØª 3 Ø¹Ù…Ù„ÙŠØ§Øª Ø¨Ø­Ø« Ø§Ù„ÙŠÙˆÙ… â€” Ø³Ø¬Ù„ Ù„ÙØªØ­ Ø§Ù„Ø¨Ø­Ø« ØºÙŠØ± Ø§Ù„Ù…Ø­Ø¯ÙˆØ¯";
t.classList.remove("hidden");
setTimeout(()=>t.classList.add("hidden"),3500);
}

/* ====== Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ====== */
async function runSmartSearch(){
if(!canSearchToday()){showLimitMsg();return;}

const query=document.getElementById("search-q").value.trim();
if(!query)return;

const resultsDiv=document.getElementById("results");
const status=document.getElementById("status-msg");

status.innerText="â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬...";
resultsDiv.innerHTML="";

try{
const res=await fetch(API_BASE);
const data=await res.json();

const ranked=smartFilterAndRank(data,query);

if(!ranked.length){
status.innerText="âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ù†Ø§Ø³Ø¨Ø©";
return;
}

status.innerText=`ğŸ” Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†: "${query}"`;

ranked.slice(0,5).forEach((item,index)=>{
increaseSearchCount();

resultsDiv.insertAdjacentHTML("beforeend",`
<div class="bg-white/10 backdrop-blur-xl rounded-3xl p-6 border border-white/10">
<div class="flex justify-between mb-2">
<h3 class="font-black text-lg">${item.title||item.name||"Ù…Ù†ØªØ¬ Ù…Ù‚ØªØ±Ø­"}</h3>
<span class="text-yellow-400 font-black">#${index+1}</span>
</div>

<p class="text-sm opacity-80 mb-3">${item.description||"ÙˆØµÙ ØºÙŠØ± Ù…ØªÙˆÙØ±"}</p>

<div class="flex justify-between items-center">
<div class="font-black text-indigo-400">${item.price?item.price+"$":"Ø³Ø¹Ø± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}</div>
${item.url?`<a href="${item.url}" target="_blank" class="bg-indigo-500 px-4 py-2 rounded-full text-xs font-bold">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬</a>`:""}
</div>

<div class="ai-recommendation-box">
ğŸ¤– Ø£ÙØ¶Ù„ ØªÙˆØ§Ø²Ù† Ø¨ÙŠÙ† Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø£Ø¯Ø§Ø¡
</div>
</div>
`);
});

}catch(err){
console.error(err);
status.innerText="âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…";
}
}
</script>

</body>
</html>
